!function($){Drupal.behaviors.tableHeader={attach:function(t,e){$.support.positionFixed&&$("table.sticky-enabled",t).once("tableheader",function(){$(this).data("drupal-tableheader",new Drupal.tableHeader(this))})}},Drupal.tableHeader=function(t){var e=this;this.originalTable=$(t),this.originalHeader=$(t).children("thead"),this.originalHeaderCells=this.originalHeader.find("> tr > th"),this.displayWeight=null,this.originalTable.bind("columnschange",function(t,i){e.widthCalculated=null!==e.displayWeight&&e.displayWeight===i,e.displayWeight=i}),this.stickyTable=$('<table class="sticky-header"/>').insertBefore(this.originalTable).css({position:"fixed",top:"0px"}),this.stickyHeader=this.originalHeader.clone(!0).hide().appendTo(this.stickyTable),this.stickyHeaderCells=this.stickyHeader.find("> tr > th"),this.originalTable.addClass("sticky-table"),$(window).bind("scroll.drupal-tableheader",$.proxy(this,"eventhandlerRecalculateStickyHeader")).bind("resize.drupal-tableheader",{calculateWidth:!0},$.proxy(this,"eventhandlerRecalculateStickyHeader")).bind("drupalDisplaceAnchor.drupal-tableheader",function(){window.scrollBy(0,-e.stickyTable.outerHeight())}).bind("drupalDisplaceFocus.drupal-tableheader",function(t){e.stickyVisible&&t.clientY<e.stickyOffsetTop+e.stickyTable.outerHeight()&&0===t.$target.closest("sticky-header").length&&window.scrollBy(0,-e.stickyTable.outerHeight())}).triggerHandler("resize.drupal-tableheader"),this.stickyHeader.show()},Drupal.tableHeader.prototype.eventhandlerRecalculateStickyHeader=function(event){var self=this,calculateWidth=event.data&&event.data.calculateWidth;this.stickyOffsetTop=Drupal.settings.tableHeaderOffset?eval(Drupal.settings.tableHeaderOffset+"()"):0,this.stickyTable.css("top",this.stickyOffsetTop+"px");var viewHeight=document.documentElement.scrollHeight||document.body.scrollHeight;(calculateWidth||this.viewHeight!==viewHeight)&&(this.viewHeight=viewHeight,this.vPosition=this.originalTable.offset().top-4-this.stickyOffsetTop,this.hPosition=this.originalTable.offset().left,this.vLength=this.originalTable[0].clientHeight-100,calculateWidth=!0);var hScroll=document.documentElement.scrollLeft||document.body.scrollLeft,vOffset=(document.documentElement.scrollTop||document.body.scrollTop)-this.vPosition;if(this.stickyVisible=vOffset>0&&vOffset<this.vLength,this.stickyTable.css({left:-hScroll+this.hPosition+"px",visibility:this.stickyVisible?"visible":"hidden"}),this.stickyVisible&&(calculateWidth||!this.widthCalculated)){this.widthCalculated=!0;for(var $that=null,$stickyCell=null,display=null,cellWidth=null,i=0,il=this.originalHeaderCells.length;i<il;i+=1)$that=$(this.originalHeaderCells[i]),$stickyCell=this.stickyHeaderCells.eq($that.index()),display=$that.css("display"),"none"!==display?(cellWidth=$that.css("width"),"auto"===cellWidth&&(cellWidth=$that[0].clientWidth+"px"),$stickyCell.css({width:cellWidth,display:display})):$stickyCell.css("display","none");this.stickyTable.css("width",this.originalTable.outerWidth())}}}(jQuery);
