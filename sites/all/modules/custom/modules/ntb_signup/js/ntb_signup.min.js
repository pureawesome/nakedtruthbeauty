!function(i){"use strict";Drupal.behaviors.ntb_signup={attach:function(i,t){var n=this;if(i===document){var s=n.getCookie();Drupal.settings.ntb_signup.cookie_length=7,s||setTimeout(function(){n.buildForm(),n.triggerOverlay()},15e3)}},buildForm:function(){var t="";t+='<div class="ntb-signup">',t+='<div class="ntb-signup-overlay"></div>',t+='<div class="ntb-signup-form">',t+='<div class="close"><i class="fa fa-times" aria-hidden="true"></i></div>',t+='<div class="ntb-signup-form-wrapper">',t+='<div class="title">'+Drupal.settings.ntb_signup.premessage+"</div>",t+='<div class="errors"></div>',t+='<div class="input-group">',t+='<input type="email" title="Please, provide an e-mail" placeholder="Email" class="form-control form-text">',t+='<span class="input-group-btn"><button class="btn form-submit button" type="submit">Submit</button></span>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",i("body").append(t)},triggerOverlay:function(){i(".ntb-signup").fadeIn(),i(".ntb-signup input").focus(),i(".ntb-signup .btn").on("click",Drupal.behaviors.ntb_signup.submit),i(".ntb-signup .close").on("click",Drupal.behaviors.ntb_signup.close),i(".ntb-signup-overlay").on("click",Drupal.behaviors.ntb_signup.close)},validateEmail:function(i){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(i)},submit:function(){var t=i(".ntb-signup input").val(),n=Drupal.behaviors.ntb_signup.validateEmail(t);return n?void i.ajax({type:"POST",dataType:"json",url:"/signup/ajax/submit/",data:{email:t}}).done(function(i){Drupal.behaviors.ntb_signup.submit_response(i)}).fail(function(){i(".ntb-signup .errors").html(Drupal.t("We're sorry. We were unable to process your email"))}):void i(".ntb-signup .errors").html(Drupal.t("That is not a valid email address."))},close:function(){i(".ntb-signup").fadeOut(),Drupal.behaviors.ntb_signup.setCookie()},submit_response:function(t){var n=t,s=i(".ntb-signup-form-wrapper");s.fadeOut(function(){i(this).html(n)}).fadeIn(),Drupal.settings.ntb_signup.cookie_length=3650},getCookie:function(){var i=new RegExp("(?:(?:^|.*;\\s*)"+Drupal.settings.ntb_signup.cookie+"\\s*\\=\\s*([^;]*).*$)|^.*$");return document.cookie.replace(i,"$1")},setCookie:function(){var i=Drupal.settings.ntb_signup.cookie,t=1,n=Drupal.settings.ntb_signup.cookie_length,s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3);var e="expires="+s.toUTCString();document.cookie=i+"="+t+"; "+e}}}(jQuery);
