!function(t){Drupal.progressBar=function(r,e,i,s){this.id=r,this.method=i||"GET",this.updateCallback=e,this.errorCallback=s,this.element=t('<div class="progress" aria-live="polite"></div>').attr("id",r),this.element.html('<div class="bar"><div class="filled"></div></div><div class="percentage"></div><div class="message">&nbsp;</div>')},Drupal.progressBar.prototype.setProgress=function(r,e){r>=0&&r<=100&&(t("div.filled",this.element).css("width",r+"%"),t("div.percentage",this.element).html(r+"%")),t("div.message",this.element).html(e),this.updateCallback&&this.updateCallback(r,e,this)},Drupal.progressBar.prototype.startMonitoring=function(t,r){this.delay=r,this.uri=t,this.sendPing()},Drupal.progressBar.prototype.stopMonitoring=function(){clearTimeout(this.timer),this.uri=null},Drupal.progressBar.prototype.sendPing=function(){if(this.timer&&clearTimeout(this.timer),this.uri){var r=this;t.ajax({type:this.method,url:this.uri,data:"",dataType:"json",success:function(t){return 0==t.status?void r.displayError(t.data):(r.setProgress(t.percentage,t.message),void(r.timer=setTimeout(function(){r.sendPing()},r.delay)))},error:function(t){r.displayError(Drupal.ajaxError(t,r.uri))}})}},Drupal.progressBar.prototype.displayError=function(r){var e=t('<div class="messages error"></div>').html(r);t(this.element).before(e).hide(),this.errorCallback&&this.errorCallback(this)}}(jQuery);
